# testing new condor genjobs for sumup_loop
python3 genjobs_sumup_loop.py 94v15 hists_3

# nvtx figures for thesis
# still not in stage2!!!! how?

# re-stage again, MC and Data
python genjobs.py 94v5 processing2NVTX --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_ext1_v1,MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_new_pmx_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v2,MC2017legacy_Fall17_TTTo2L2Nu,MC2017legacy_Fall17_TTToHadronic_13TeV_v2,MC2017legacy_Fall17_TTToSemiLeptonic_new_pmx_v1,MC2017legacy_Fall17_TTToSemiLeptonic_v2,MC2017legacy_Fall17_WJets_madgraph_ext1v2,MC2017legacy_Fall17_WJets_madgraph_v2,MC2017legacy_Fall17_WJets_madgraph_v3

# Data
python genjobs.py 94v10 processing2NVTX --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags Data2017legacy_13TeV_SingleElectron_2017B,Data2017legacy_13TeV_SingleElectron_2017C,Data2017legacy_13TeV_SingleElectron_2017D,Data2017legacy_13TeV_SingleElectron_2017E,Data2017legacy_13TeV_SingleElectron_2017F,Data2017legacy_13TeV_SingleMuon_2017B,Data2017legacy_13TeV_SingleMuon_2017C,Data2017legacy_13TeV_SingleMuon_2017D,Data2017legacy_13TeV_SingleMuon_2017E,Data2017legacy_13TeV_SingleMuon_2017F

# on pauli @ LIP
python genjobs.py v37 processing2NVTX --dsets-info-filename dsets_info_old.yaml --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system qsub   --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver3

#and MC
python genjobs.py v37 processing2NVTX --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_ext1_v1,MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_new_pmx_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v2,MC2017legacy_Fall17_TTTo2L2Nu,MC2017legacy_Fall17_TTToHadronic_13TeV_v2,MC2017legacy_Fall17_TTToSemiLeptonic_new_pmx_v1,MC2017legacy_Fall17_TTToSemiLeptonic_v2,MC2017legacy_Fall17_WJets_madgraph_ext1v2,MC2017legacy_Fall17_WJets_madgraph_v2,MC2017legacy_Fall17_WJets_madgraph_v3

python genjobs.py v37 processing2NVTX --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_ext1_v1,MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_new_pmx_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v2,MC2017legacy_Fall17_TTTo2L2Nu,MC2017legacy_Fall17_TTToHadronic_13TeV_v2,MC2017legacy_Fall17_TTToSemiLeptonic_new_pmx_v1,MC2017legacy_Fall17_TTToSemiLeptonic_v2,MC2017legacy_Fall17_WJets_madgraph_ext1v2,MC2017legacy_Fall17_WJets_madgraph_v2,MC2017legacy_Fall17_WJets_madgraph_v3

# MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_ext1_v1,MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_new_pmx_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v2,MC2017legacy_Fall17_TTTo2L2Nu,MC2017legacy_Fall17_TTToHadronic_13TeV_v2,MC2017legacy_Fall17_TTToSemiLeptonic_new_pmx_v1,MC2017legacy_Fall17_TTToSemiLeptonic_v2,MC2017legacy_Fall17_WJets_madgraph_ext1v2,MC2017legacy_Fall17_WJets_madgraph_v2,MC2017legacy_Fall17_WJets_madgraph_v3

# -- did the old stage2

# finally
make histograms_to_fit nt=v37  proc=processing2NVTX       hists=plot1 simulate_data_output=0     systematics=NOMINAL,PUUp,PUDown  channels=el_sel,el_sel_ss,mu_sel,mu_sel_ss processes=std distrs=Mt_lep_met_c,leading_lep_pt,tau_pt,nvtx
make histograms_to_fit nt=v37  proc=processing2NVTXmcHADD hists=plot1 simulate_data_output=0     systematics=NOMINAL,PUUp,PUDown  channels=el_sel,el_sel_ss,mu_sel,mu_sel_ss processes=std distrs=Mt_lep_met_c,leading_lep_pt,tau_pt,nvtx

# and old presel with lj parameters
make histograms_to_fit nt=v37  proc=processing2NVTX       hists=plot2 simulate_data_output=0     systematics=NOMINAL  channels=el_old_presel,el_old_presel_ss,mu_old_presel,mu_old_presel_ss processes=std distrs=Mt_lep_met_c,leading_lep_pt,tau_pt,lj_var,lj_var_w_mass,lj_var_t_mass
make histograms_to_fit nt=v37  proc=processing2NVTXmcHADD hists=plot2 simulate_data_output=0     systematics=NOMINAL  channels=el_old_presel,el_old_presel_ss,mu_old_presel,mu_old_presel_ss processes=std distrs=Mt_lep_met_c,leading_lep_pt,tau_pt,lj_var,lj_var_w_mass,lj_var_t_mass


# NOMINAL figures with data, NO DY
make histograms_to_fit nt=94v5  proc=processing2 hists=plot1 simulate_data_output=0     systematics=NOMINAL  channels=el_sel,el_sel_ss,mu_sel,mu_sel_ss,el_sel_tauSV3,mu_sel_tauSV3,el_sel_ss_tauSV3,mu_sel_ss_tauSV3,tt_elmu_tight processes=std distrs=Mt_lep_met_c,leading_lep_pt,tau_pt,tau_sv_sign
make histograms_to_fit nt=94v10 proc=processing2 hists=plot1 simulate_data_output=0     systematics=NOMINAL  channels=el_sel,el_sel_ss,mu_sel,mu_sel_ss,el_sel_tauSV3,mu_sel_tauSV3,el_sel_ss_tauSV3,mu_sel_ss_tauSV3,tt_elmu_tight processes=std distrs=Mt_lep_met_c,leading_lep_pt,tau_pt,tau_sv_sign

make histograms_to_fit exe=sumup_loop_test nt=94v10 proc=processing2 hists=plot1 simulate_data_output=0     systematics=NOMINAL  channels=el_sel,el_sel_ss,mu_sel,mu_sel_ss,el_sel_tauSV3,mu_sel_tauSV3,el_sel_ss_tauSV3,mu_sel_ss_tauSV3,tt_elmu_tight processes=std distrs=Mt_lep_met_c,leading_lep_pt,tau_pt,tau_sv_sign

# for the fit
make histograms_to_fit nt=94v5  proc=processing2 hists=fit1  simulate_data_output=1     channels=el_sel_tauSV3,mu_sel_tauSV3,el_sel_ss_tauSV3,mu_sel_ss_tauSV3,tt_elmu_tight,dy_mutau_tauSV3,dy_mumu processes=std distrs=Mt_lep_met_c,leading_lep_pt,tau_pt


# re-stage, MC and Data
python genjobs.py 94v5 processing2 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_ext1_v1,MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_new_pmx_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v2,MC2017legacy_Fall17_TTTo2L2Nu,MC2017legacy_Fall17_TTToHadronic_13TeV_v2,MC2017legacy_Fall17_TTToSemiLeptonic_new_pmx_v1,MC2017legacy_Fall17_TTToSemiLeptonic_v2,MC2017legacy_Fall17_WJets_madgraph_ext1v2,MC2017legacy_Fall17_WJets_madgraph_v2,MC2017legacy_Fall17_WJets_madgraph_v3

# Data
python genjobs.py 94v10 processing2 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags Data2017legacy_13TeV_SingleElectron_2017B,Data2017legacy_13TeV_SingleElectron_2017C,Data2017legacy_13TeV_SingleElectron_2017D,Data2017legacy_13TeV_SingleElectron_2017E,Data2017legacy_13TeV_SingleElectron_2017F,Data2017legacy_13TeV_SingleMuon_2017B,Data2017legacy_13TeV_SingleMuon_2017C,Data2017legacy_13TeV_SingleMuon_2017D,Data2017legacy_13TeV_SingleMuon_2017E,Data2017legacy_13TeV_SingleMuon_2017F



# I need the background!!
python genjobs.py 94v5 processingTestB2L --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags MC2017legacy_Fall17_TTToSemiLeptonic_v2
python genjobs.py 94v5 processingTestB1M --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags MC2017legacy_Fall17_TTToSemiLeptonic_v2
python genjobs.py 94v5 processingTestBonly1M --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags MC2017legacy_Fall17_TTToSemiLeptonic_v2,MC2017legacy_Fall17_TTTo2L2Nu

# testing b-tagging
python genjobs.py 94v5 processingTestB2L --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags MC2017legacy_Fall17_TTTo2L2Nu
python genjobs.py 94v5 processingTestB1M --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags MC2017legacy_Fall17_TTTo2L2Nu

# check the real electron pT edge
make histograms_to_fit nt=94v5 proc=processing1 hists=checkEleEdge      systematics=NOMINAL  channels=el_sel_tauSV3,el_sel processes=std distrs=leading_lep_pt_el_edge35 dtags_grep=TTTo2L

# fitting
make histograms_to_fit nt=94v5 proc=processing1 hists=fit1DataSum        channels=el_sel_tauSV3,mu_sel_tauSV3,el_sel_ss_tauSV3,mu_sel_ss_tauSV3,dy_mutau_tauSV3,dy_mumu,tt_elmu_tight processes=std distrs=Mt_lep_met_c,leading_lep_pt,tau_pt

make histograms_to_fit nt=94v5 proc=processing1 hists=fit3 lumi=1000000  channels=el_sel_tauSV3,mu_sel_tauSV3,el_sel_ss_tauSV3,mu_sel_ss_tauSV3,dy_mutau_tauSV3,dy_mumu,tt_elmu_tight processes=std distrs=Mt_lep_met_c,leading_lep_pt,tau_pt
make histograms_to_fit nt=94v5 proc=processing1 hists=fit2 lumi=140000   channels=el_sel_tauSV3,mu_sel_tauSV3,el_sel_ss_tauSV3,mu_sel_ss_tauSV3,dy_mutau_tauSV3,dy_mumu,tt_elmu_tight processes=std distrs=Mt_lep_met_c,leading_lep_pt,tau_pt
make histograms_to_fit nt=94v5 proc=processing1 hists=fit1               channels=el_sel_tauSV3,mu_sel_tauSV3,el_sel_ss_tauSV3,mu_sel_ss_tauSV3,dy_mutau_tauSV3,dy_mumu,tt_elmu_tight processes=std distrs=Mt_lep_met_c,leading_lep_pt,tau_pt

make histograms_to_fit nt=94v4 proc=processing3 hists=fit1  distrs=Mt_lep_met_c,leading_lep_pt

# plot stuff
make histograms_to_fit nt=94v5 proc=processing1 hists=plot2 systematics=NOMINAL channels=all processes=all distrs=Mt_lep_met_c,leading_lep_pt,met_f,sum_cos,dilep_mass,dilep_mass_dy_tautau,tau_pt,tau_sv_sign
make histograms_to_fit nt=94v5 proc=processing1 hists=plot1 systematics=NOMINAL channels=all processes=all distrs=Mt_lep_met_c,leading_lep_pt,met_f,sum_cos,dilep_mass,dilep_mass_dy_tautau
make histograms_to_fit nt=94v4 proc=processing3 hists=plot1 systematics=NOMINAL channels=all distrs=Mt_lep_met_c,leading_lep_pt,met_f,sum_cos

# new ntuples, 2017 corrections and uncertainties
python genjobs.py 94v4 processing3 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_ext1_v1,MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_new_pmx_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v2,MC2017legacy_Fall17_TTTo2L2Nu,MC2017legacy_Fall17_TTToHadronic_13TeV_v2,MC2017legacy_Fall17_TTToSemiLeptonic_new_pmx_v1,MC2017legacy_Fall17_TTToSemiLeptonic_v2,MC2017legacy_Fall17_WJets_madgraph_ext1v2,MC2017legacy_Fall17_WJets_madgraph_v2,MC2017legacy_Fall17_WJets_madgraph_v3

#
python genjobs.py 94v1 processing2 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags MC2017legacy_Fall17_TTTo2L2Nu

python genjobs.py 94v1 processing2 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags Data2017legacy_13TeV_SingleMuon_B,Data2017legacy_13TeV_SingleMuon_C,Data2017legacy_13TeV_SingleMuon_D,Data2017legacy_13TeV_SingleMuon_E,Data2017legacy_13TeV_SingleMuon_F,Data2017legacy_13TeV_SingleElectron_B,Data2017legacy_13TeV_SingleElectron_C,Data2017legacy_13TeV_SingleElectron_D,Data2017legacy_13TeV_SingleElectron_E,Data2017legacy_13TeV_SingleElectron_F,MC2017legacy_Fall17_TTTo2L2Nu

python genjobs.py 94v1 processing2 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags Data2017legacy_13TeV_SingleMuon_B,Data2017legacy_13TeV_SingleMuon_C,Data2017legacy_13TeV_SingleMuon_D,Data2017legacy_13TeV_SingleMuon_E,Data2017legacy_13TeV_SingleMuon_F,Data2017legacy_13TeV_SingleElectron_B,Data2017legacy_13TeV_SingleElectron_C,Data2017legacy_13TeV_SingleElectron_D,Data2017legacy_13TeV_SingleElectron_E,Data2017legacy_13TeV_SingleElectron_F

python genjobs.py 94v1 processing2 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --batch-system condor --dtags MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_ext1_v1,MC2017legacy_Fall17_DYJetsToLL_50toInf_madgraph_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_new_pmx_v1,MC2017legacy_Fall17_SingleT_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v1,MC2017legacy_Fall17_SingleTbar_tW_5FS_powheg_v2,MC2017legacy_Fall17_TTTo2L2Nu,MC2017legacy_Fall17_TTToHadronic_13TeV_v2,MC2017legacy_Fall17_TTToSemiLeptonic_new_pmx_v1,MC2017legacy_Fall17_TTToSemiLeptonic_v2,MC2017legacy_Fall17_WJets_madgraph_ext1v2,MC2017legacy_Fall17_WJets_madgraph_v2,MC2017legacy_Fall17_WJets_madgraph_v3


# produce the ntuples with PAT SV flight length
python genjobs.py v37 testPATSVflightLength  --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --dtags MC2016_Summer16_TTJets_powheg          --jobs-name-tag tt

# more control plots of final selection
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test172 --distrs bunchFULLFIT1BIN1 --chan-groups fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test172 --distrs bunchCONTROLS1 --chan-groups tt_leptau,tt_leptau_lj,tt_leptau_ljout,tt_leptau_Vloose,tt_leptau_Vloose_lj,tt_leptau_Vloose_ljout,tt_presel_cands,tt_presel_cands_lj,tt_presel_cands_ljout,wjets,wjets_ss,dy_leptau,dy_leptau_ss,tt_dileptons,dy_dileptons

# full uncertainty in Mt
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test172 --distrs bunchMTBIN1 --chan-groups fit_tt_leptau,fit_tt_leptau_Vloose

# test20: test15 + no lepjet JER and taujet JER (which does not matter) and no per-epoch avverage of muon lep and PU!
python genjobs.py v37 test20  --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --dtags MC2016_Summer16_TTJets_powheg          --jobs-name-tag tt
python genjobs.py v37 test20  --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --without-dtags MC2016_Summer16_TTJets_powheg,std_data --jobs-name-tag mc

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test20 --distrs bunchFULLFIT1BIN1 --chan-groups fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout

# reproduce test15 with no taujet JER -- I have this? 00 yeah, 174 but it has only TT!
python genjobs.py v37 test152 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --dtags MC2016_Summer16_TTJets_powheg,std_data --jobs-name-tag tt_data
python genjobs.py v37 test152 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --without-dtags MC2016_Summer16_TTJets_powheg,std_data

python genjobs.py v37 test152 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --dtags qcd_ext,updowns,updowns_extra,wjets_amcatnlo --jobs-name-tag extra

# just plots first:
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test15 --distrs bunchFULLFIT1BIN1 --chan-groups fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout


# 
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test172 --distrs bunchFULLFIT1BIN1 --chan-groups fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout



# JER from taujets is not propagated -- let's repeat uncor lepjet
python genjobs.py v37 test176 --options on_uncor_lepjets  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue                 --dtags MC2016_Summer16_TTJets_powheg,std_data --jobs-name-tag tt_data

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test176 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --dtags MC2016_Summer16_TTJets_powheg,Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3

python genjobs.py v37 test176 --options on_uncor_lepjets  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --without-dtags MC2016_Summer16_TTJets_powheg,std_data --jobs-name-tag mc

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test176 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --without-dtags MC2016_Summer16_TTJets_powheg,Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3


# test175: uncor lepjets and taujets, propagate JER only from pure jets
# sadly the uncor is done in data too
python genjobs.py v37 test175 --options on_uncor_lepjets,on_uncor_taujets  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue                 --dtags MC2016_Summer16_TTJets_powheg,std_data --jobs-name-tag tt_data

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test175 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --dtags MC2016_Summer16_TTJets_powheg,Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3


# excluded tau matched jet from jer prop and b weights
python genjobs.py v37 test174 --options none  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue            --dtags MC2016_Summer16_TTJets_powheg          --jobs-name-tag tt

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test174 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --dtags MC2016_Summer16_TTJets_powheg
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test174 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --dtags MC2016_Summer16_TTJets_powheg

# JER from all jets is propagated to met
python genjobs.py v37 test173 --options none  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue            --dtags MC2016_Summer16_TTJets_powheg          --jobs-name-tag tt
python genjobs.py v37 test173 --options none  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue    --without-dtags MC2016_Summer16_TTJets_powheg,std_data --jobs-name-tag mc
python genjobs.py v37 test173 --options none  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue            --dtags qcd_ext,updowns,updowns_extra,wjets_amcatnlo --jobs-name-tag extra

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test173 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --without-dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3

# a mistake in lepjet removal in jes and jer variations of met
python genjobs.py v37 test172 --options on_uncor_lepjets  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue                 --dtags MC2016_Summer16_TTJets_powheg,std_data --jobs-name-tag tt_data

python genjobs.py v37 test172 --options on_uncor_lepjets  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --without-dtags MC2016_Summer16_TTJets_powheg,std_data
python genjobs.py v37 test172 --options on_uncor_lepjets  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue                 --dtags qcd_ext,updowns,updowns_extra,wjets_amcatnlo --jobs-name-tag extra

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test172 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test172 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test172 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --dtags MC2016_Summer16_TTJets_powheg,Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test172 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --without-dtags MC2016_Summer16_TTJets_powheg,Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3


python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test172 --distrs bunchCONTROLS1 --chan-groups tt_leptau,tt_leptau_lj,tt_leptau_ljout,tt_leptau_Vloose,tt_leptau_Vloose_lj,tt_leptau_Vloose_ljout,tt_presel_cands,tt_presel_cands_lj,tt_presel_cands_ljout,wjets,wjets_ss,dy_leptau,dy_leptau_ss,tt_dileptons,dy_dileptons



# tests of correct handling of the lep jet
python genjobs.py v37 test18 --options on_remove_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue                 --dtags MC2016_Summer16_TTJets_powheg --jobs-name-tag tt
python genjobs.py v37 test18 --options on_remove_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --without-dtags MC2016_Summer16_TTJets_powheg

python genjobs.py v37 test17 --options on_uncor_lepjets  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue                 --dtags MC2016_Summer16_TTJets_powheg --jobs-name-tag tt
python genjobs.py v37 test17 --options on_uncor_lepjets  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --without-dtags MC2016_Summer16_TTJets_powheg
python genjobs.py v37 test17 --options on_uncor_lepjets  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue                 --dtags qcd_ext,updowns,updowns_extra,wjets_amcatnlo --jobs-name-tag extra
# data failed
python genjobs.py v37 test17 --options on_uncor_lepjets  --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue                 --dtags std_data --jobs-name-tag data

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test17 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test17 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3



# compare to prop lep jets
python genjobs.py v37 test16 --options on_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --dtags MC2016_Summer16_TTJets_powheg --jobs-name-tag tt
python genjobs.py v37 test16 --options on_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --without-dtags MC2016_Summer16_TTJets_powheg
python genjobs.py v37 test16 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --dtags qcd_ext,updowns,updowns_extra,wjets_amcatnlo --jobs-name-tag extra

# test15, fixed jet collections for lj calculation in MC: only nominal jets, not the JES etc variations
# -- noticeable couple percent difference in mu_selVloose in TT
python genjobs.py v37 test15 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --dtags MC2016_Summer16_TTJets_powheg --jobs-name-tag tt
python genjobs.py v37 test15 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --without-dtags MC2016_Summer16_TTJets_powheg
python genjobs.py v37 test15 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --dtags qcd_ext,updowns,updowns_extra,wjets_amcatnlo --jobs-name-tag extra

# plot full fit, presel and sel
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test15 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout

# check if presel include lj params
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test15 --distrs bunchMAINSEL1 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout


# test14, fixed LEPmu Up Down weights
python genjobs.py v37 test14 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue
python genjobs.py v37 test14 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --dtags MC2016_Summer16_TTJets_powheg --jobs-name-tag tt
python genjobs.py v37 test14 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --without-dtags MC2016_Summer16_TTJets_powheg
python genjobs.py v37 test14 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue         --dtags qcd_ext,updowns,updowns_extra,wjets_amcatnlo

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test14 --distrs bunchFULLFIT3 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout



# add all updowns, qcd ext and wjets amcatnlo
# test13, full run with corrected met propagation -- no propagation to Data
python genjobs.py v37 test13 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue        --dtags qcd_ext,updowns,updowns_extra,wjets_amcatnlo

# plot dileps and full fit
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test13 --distrs bunchDILEP1   --chan-groups dy_dileptons,tt_dileptons
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test13 --distrs bunchFULLFIT1 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test13 --distrs bunchFULLFIT2 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout
python loop_selections.py --no-queue --job-dir temp/jobs/ --options " --wjets-nup-cut " --nt v37 --proc test13 --distrs bunchFULLFIT2 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout

# add the tt updowns
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test13 --distrs bunchFULLFIT2 --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --dtags MC2016_Summer16_TTJets_powheg_CUETP8M2T4down,MC2016_Summer16_TTJets_powheg_CUETP8M2T4down_ext1,MC2016_Summer16_TTJets_powheg_CUETP8M2T4up,MC2016_Summer16_TTJets_powheg_CUETP8M2T4up_ext1,MC2016_Summer16_TTJets_powheg_fsrdown,MC2016_Summer16_TTJets_powheg_fsrdown_ext1,MC2016_Summer16_TTJets_powheg_fsrdown_ext2,MC2016_Summer16_TTJets_powheg_fsrup,MC2016_Summer16_TTJets_powheg_fsrup_ext1,MC2016_Summer16_TTJets_powheg_fsrup_ext2,MC2016_Summer16_TTJets_powheg_hdampDOWN,MC2016_Summer16_TTJets_powheg_hdampDOWN_ext1,MC2016_Summer16_TTJets_powheg_hdampUP,MC2016_Summer16_TTJets_powheg_hdampUP_ext1,MC2016_Summer16_TTJets_powheg_isrdown,MC2016_Summer16_TTJets_powheg_isrdown_ext1,MC2016_Summer16_TTJets_powheg_isrdown_ext2,MC2016_Summer16_TTJets_powheg_isrup

# and the mets..
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test13 --distrs bunchCONTROLMET --chans mu_sel,mu_sel_ss,el_sel,el_sel_ss,mu_preselCand,mu_preselCand_ss,el_preselCand,el_preselCand_ss,wjets_mu,wjets_mu_ss,wjets_el,wjets_el_ss,tt_elmu --distributions met_c,met_f,met_f2 --sys NOMINAL,TOPPTUp



# presel, sel, wjets and dy_tautau controls
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test13 --distrs bunchCONTROLS1 --chan-groups tt_leptau,tt_leptau_lj,tt_leptau_ljout,tt_leptau_Vloose,tt_leptau_Vloose_lj,tt_leptau_Vloose_ljout,tt_leptau_Tight,tt_leptau_Tight_lj,tt_leptau_Tight_ljout,tt_presel_cands,tt_presel_cands_lj,tt_presel_cands_ljout,wjets,wjets_ss,dy_leptau,dy_leptau_ss

# yields
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test13 --distrs bunch1YIELDS --chan-groups yields_el_presel,yields_el_sel,yields_mu_presel,yields_mu_sel,yields_control_wjets,yields_control_dyjets,yields_control_tt_em
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test13 --distrs bunch1YIELDS --chan-groups yields_control_dyleptau
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test13 --distrs bunch1YIELDS --chan-groups yields_control_dyleptau --dtags MC2016_Summer16_QCD_HT-1000-1500_ext1,MC2016_Summer16_QCD_HT-1500-2000_ext1,MC2016_Summer16_QCD_HT-200-300_ext1,MC2016_Summer16_QCD_HT-2000-Inf_ext1,MC2016_Summer16_QCD_HT-300-500_ext1,MC2016_Summer16_QCD_HT-500-700_ext1,MC2016_Summer16_QCD_HT-700-1000_ext1




# test12 without dR check in dileptons -- for sync of stage2 and sumup_draw.py script in Data
python genjobs.py v37 test12 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue        --dtags MC2016_Summer16_TTJets_powheg,Data13TeV_SingleMuon2016H_03Feb2017_ver2
python genjobs.py --queue-dir temp/jobs/ v37 test12 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue_online --dtags MC2016_Summer16_TTJets_powheg,Data13TeV_SingleMuon2016H_03Feb2017_ver2

python loop_selections.py --no-queue --options " --wjets-nup-cut " --nt v37 --proc test12 --distrs bunchDILEP3 --sys NOMINAL --chan-groups tt_dileptons --dtags MC2016_Summer16_TTJets_powheg,Data13TeV_SingleMuon2016H_03Feb2017_ver2

# recalculate mT from the init met
# in test11 -- it has all MC
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test11 --distrs bunchDILEP3recalc --sys NOMINAL --chan-groups tt_dileptons --dtags MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_TTJets_powheg,Data13TeV_SingleMuon2016H_03Feb2017_ver2
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test11 --distrs bunchDILEP3recalc --sys NOMINAL --chan-groups dy_dileptons --dtags MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_TTJets_powheg,Data13TeV_SingleMuon2016H_03Feb2017_ver2
# the queue runs, so just all:
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test11 --distrs bunchDILEP3recalc --sys NOMINAL --chan-groups tt_dileptons,dy_dileptons

python loop_selections.py --no-queue --options " --wjets-nup-cut " --nt v37 --proc test11 --distrs bunchDILEP3recalc --sys NOMINAL --chan-groups tt_dileptons,dy_dileptons --without-dtags MC2016_Summer16_TTJets_powheg,Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3

# finally, the rest of data for v37_test11_bunchDILEP3recalc_mc_2_limited
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test11 --distrs bunchDILEP3recalc --sys NOMINAL --chan-groups tt_dileptons,dy_dileptons --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3
# and repeat MuonH for sync
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test11 --distrs bunchDILEP3recalc --sys NOMINAL --chan-groups tt_dileptons,dy_dileptons --dtags Data13TeV_SingleMuon2016H_03Feb2017_ver2


# test11 with impacts on muon
python genjobs.py v37 test11 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags MC2016_Summer16_TTJets_powheg,singletop,dibosons,std_data
python genjobs.py v37 test11 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags MC2016_Summer16_DYJetsToLL_50toInf_madgraph --queue-dir queue2_dir/

python genjobs.py v37 test11 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags std_mc,wjets_amcatnlo,std_data --without-dtags wjets

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test11 --distrs bunchDILEP3 --chan-groups tt_dileptons,tt_dileptons_tight --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3,MC2016_Summer16_SingleT_tW_5FS_powheg,MC2016_Summer16_SingleTbar_tW_5FS_powheg,MC2016_Summer16_TTJets_powheg,MC2016_Summer16_WWTo2L2Nu_powheg,MC2016_Summer16_WWToLNuQQ_powheg,MC2016_Summer16_WZTo1L1Nu2Q_amcatnlo_madspin,MC2016_Summer16_WZTo1L3Nu_amcatnlo_madspin,MC2016_Summer16_WZTo2L2Q_amcatnlo_madspin,MC2016_Summer16_WZTo3LNu_powheg,MC2016_Summer16_ZZTo2L2Nu_powheg,MC2016_Summer16_ZZTo2L2Q_amcatnlo_madspin,MC2016_Summer16_schannel_4FS_leptonicDecays_amcatnlo,MC2016_Summer16_tchannel_antitop_4f_leptonicDecays_powheg,MC2016_Summer16_tchannel_top_4f_leptonicDecays_powheg,MC2016_Summer16_DYJetsToLL_50toInf_madgraph

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test11 --distrs bunchDILEP3 --chan-groups tt_dileptons,tt_dileptons_tight

# weightless TT for comparisons with sumup_draw and v12
python loop_selections.py --no-queue --options " --wjets-nup-cut " --nt v37 --proc test11 --distrs bunchDILEP3WeightLess --sys INITIAL --chan-groups tt_dileptons --dtags MC2016_Summer16_TTJets_powheg


# test10 the tt_elmu_mu
python genjobs.py v37 test10 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags std_mc,std_data
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test10 --distrs bunchDILEP3 --chan-groups tt_dileptons,tt_dileptons_tight

# test9 testing the gen nvtx for lep SFs
# --- not much of a difference
python genjobs.py v37 test9 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags MC2016_Summer16_TTJets_powheg
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test9 --distrs bunchDILEP3 --chan-groups tt_dileptons


# correct per-epoch PU
python genjobs.py v37 test8 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags std_mc,wjets_amcatnlo,std_qcd,dy_std,dy_ext

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test8 --distrs bunchDILEP3 --chan-groups dy_dileptons,tt_dileptons

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test8 --distrs bunchDILEP3_INITIAL --chan-groups tt_dileptons --sys INITIAL

# the correctly averaged per-epoch PU and muon LEP SFs
python genjobs.py v37 test7 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue_online --dtags MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_TTJets_powheg

make run_script_jobs job_dir=queue_dir/v37/test7/jobs_dir/

python genjobs.py v37 test7 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags std_mc,wjets_amcatnlo,std_qcd,dy_std,dy_ext --without-dtags MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_TTJets_powheg

make run_script_jobs job_dir=queue_dir/v37/test7/jobs_dir/

# disk quota and failed files
wc -l j_*.e* | grep "^[ ]*22 " | sed -n 's,.*\(MC2016[^.]*\)_\([0-9][0-9]*\)\.root.*,lstore_outdirs/v37/test7/\1/\1_\2.root,p' > failed_files

# also finish test6 data (maybe some jobs crashed in the middle!)
python genjobs.py v37 test6 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags std_data

# and plots
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test6 --distrs bunchDILEP3 --chan-groups dy_dileptons,tt_dileptons --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3


# and a tight tt_elmu
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test8 --distrs bunchDILEP3tight --chan-groups tt_dileptons_tight

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test6 --distrs bunchDILEP3tight --chan-groups tt_dileptons_tight --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3

# while jobs don't run let's try plotting only main datasets
python loop_selections.py --no-queue --options " --wjets-nup-cut " --nt v37 --proc test7 --distrs bunchDILEP3 --chan-groups dy_dileptons,tt_dileptons --dtags MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_TTJets_powheg

# finish other MC in queue -- to see clean tt_elmu
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test7 --distrs bunchDILEP3 --chan-groups dy_dileptons,tt_dileptons --without-dtags MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_TTJets_powheg
# again
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test7 --distrs bunchDILEP3 --chan-groups dy_dileptons,tt_dileptons --without-dtags MC2016_Summer16_TTJets_powheg




# and data?
# no, use test5:
# DONE make the data with new lep pT > 32. cuts in elmu
python loop_selections.py --no-queue --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunchDILEP3 --chan-groups tt_dileptons --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3

make run_script_jobs job_dir=batch_jobs/


# corrected lep IDs for dileptons
python genjobs.py v37 test6 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags std_mc,wjets_amcatnlo,std_qcd,dy_std,dy_ext

python genjobs.py v37 test6 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags MC2016_Summer16_TTJets_powheg
python genjobs.py v37 test6 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags std_mc,wjets_amcatnlo,std_qcd,dy_std,dy_ext --without-dtags MC2016_Summer16_TTJets_powheg

python genjobs.py v37 test6 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags std_mc
python genjobs.py v37 test6 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags wjets_amcatnlo,std_qcd,dy_std,dy_ext

process online
grep "^python" queue_dir/v37/test6/jobs_dir/job_* > queue_dir/v37/test6/all_jobs1
sed -i 's/queue[^:]*://' queue_dir/v37/test6/all_jobs_both

make run_jobs_script jobs_script=queue_dir/v37/test6/all_jobs_both

python loop_selections.py --no-queue --options " --wjets-nup-cut " --nt v37 --proc test6 --distrs bunch3 --chan-groups dy_dileptons,tt_dileptons
cat batch_jobs/*.root > batch_jobs/all_jobs

split -l 1512 batch_jobs/all_jobs batch_jobs/all_jobs.
make run_jobs_script jobs_script=batch_jobs/all_jobs.aa
make run_jobs_script jobs_script=batch_jobs/all_jobs.ab

# also it has SameSign dy_tautau_ss

python loop_selections.py --no-queue --options " --wjets-nup-cut " --nt v37 --proc test6 --distrs bunch4 --chan-groups dy_leptau,dy_leptau_ss --only-nominal

# and data
python loop_selections.py --no-queue --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunch4DYtautau --chan-groups dy_leptau,dy_leptau_ss --only-nominal --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3

make run_script_jobs job_dir=batch_jobs/

# -- damn, test5 does not have the dy_tautau_ss!
python genjobs.py v37 test6 --options no_prop_lepjets --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue_online --dtags std_data
make run_script_jobs job_dir=queue_dir/v37/test6/jobs_dir/

# and repeat the plots
python loop_selections.py --no-queue --options " --wjets-nup-cut " --nt v37 --proc test6 --distrs bunch4DYtautau --chan-groups dy_leptau,dy_leptau_ss --only-nominal --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3

make run_script_jobs job_dir=batch_jobs/


# the full fit in new ntuples
python loop_selections.py --no-queue --options " --wjets-nup-cut " --nt v37 --proc test6 --distrs bunch5Fit --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --job-dir temp/jobs/

make run_script_jobs job_dir=temp/jobs/

# with queue
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunch5Fit --chan-groups fit_tt_leptau,fit_tt_leptau_lj,fit_tt_leptau_ljout,fit_tt_leptau_Vloose,fit_tt_leptau_Vloose_lj,fit_tt_leptau_Vloose_ljout --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3


# the question on ISR gen lep pt-s in the acceptance
python genjobs.py v34 t1 --acceptance-study channels_nom_sys_both_sel_main --dtags MC2016_Summer16_TTJets_powheg,updowns,updowns_extra --scheme 5,5,2,12,12
make sub_proc nt=v34 proc=t1 node=1

# run with "unclustered" lep-matched jets propagated to met in both data and mc
# the jes correction of the lep-matched jet is returned to met
# "unclustering" does not mean anything here, it is just anti-jes propagation
python genjobs.py v37 test5 --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags data_mu,data_el,wjets_amcatnlo,std_qcd,dy_std,dy_ext --options no_prop_lepjets
python genjobs.py v37 test5 --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags std_mc --without-dtags wjets_amcatnlo,std_qcd,dy_std,dy_ext --options no_prop_lepjets
python genjobs.py v37 test5 --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags MC2016_Summer16_TTJets_powheg  --options no_prop_lepjets

python genjobs.py v37 test5 --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags std_mc --without-dtags wjets_amcatnlo,std_qcd,dy_std,dy_ext,MC2016_Summer16_TTJets_powheg --options no_prop_lepjets

also missing jobs in:

python genjobs.py v37 test5 --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --options no_prop_lepjets --dtags MC2016_Summer16_SingleT_tW_5FS_powheg,MC2016_Summer16_SingleTbar_tW_5FS_powheg,MC2016_Summer16_W1Jets_madgraph,MC2016_Summer16_W2Jets_madgraph,MC2016_Summer16_W2Jets_madgraph_ext1,MC2016_Summer16_W3Jets_madgraph,MC2016_Summer16_W3Jets_madgraph_ext1,MC2016_Summer16_W4Jets_madgraph,MC2016_Summer16_W4Jets_madgraph_ext1,MC2016_Summer16_W4Jets_madgraph_ext2,MC2016_Summer16_WJets_madgraph,MC2016_Summer16_WJets_madgraph_ext2_v1,MC2016_Summer16_WWTo2L2Nu_powheg,MC2016_Summer16_WZTo1L1Nu2Q_amcatnlo_madspin,MC2016_Summer16_ZZTo2L2Nu_powheg,MC2016_Summer16_ZZTo2L2Q_amcatnlo_madspin,MC2016_Summer16_tchannel_top_4f_leptonicDecays_powheg


# with different met for data --- no difference
python genjobs.py v37 test2 --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags data_mu,data_el
# with sorting tau cands by pT only --- should not matter, since the majority of candidates do not pass any ID
python genjobs.py v37 test3 --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags data_mu,data_el
# shooting at the sky of met propagation variants
python genjobs.py v37 test4 --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags wjets_amcatnlo,data_mu,data_el  --options no_prop_lepjets
python genjobs.py v37 test4 --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags data_mu,data_el --options no_prop_lepjets
python genjobs.py v37 test4 --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags std_qcd         --options no_prop_lepjets
python genjobs.py v37 test4 --do-W-stitching --metmuegclean false channels_nom_sys_muon_sel_main --submit queue --dtags dy_std,dy_ext   --options no_prop_lepjets

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test2 --distrs bunch1 --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3 --chan-groups wjets,wjets_ss

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test3 --distrs bunch1 --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3 --chan-groups wjets,wjets_ss

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test4 --distrs bunch1 --dtags MC2016_Summer16_WJets_amcatnlo,MC2016_Summer16_WJets_amcatnlo_ext2_v2 --chan-groups wjets,wjets_ss
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test4 --distrs bunch1 --dtags MC2016_Summer16_WJets_amcatnlo,MC2016_Summer16_WJets_amcatnlo_ext2_v2,MC2016_Summer16_QCD_HT-100-200,MC2016_Summer16_QCD_HT-1000-1500,MC2016_Summer16_QCD_HT-1500-2000,MC2016_Summer16_QCD_HT-200-300,MC2016_Summer16_QCD_HT-2000-Inf,MC2016_Summer16_QCD_HT-300-500,MC2016_Summer16_QCD_HT-500-700,MC2016_Summer16_QCD_HT-700-1000 --chan-groups wjets,wjets_ss

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test4 --distrs bunch1 --dtags MC2016_Summer16_DYJetsToLL_10to50_amcatnlo,MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_DYJetsToLL_10to50_amcatnlo_v1_ext1,MC2016_Summer16_DYJetsToLL_50toInf_madgraph_ext2_v1,MC2016_Summer16_DYJetsToLL_10to50_amcatnlo_v2 --chan-groups wjets,wjets_ss

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunch1 --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3,MC2016_Summer16_WJets_amcatnlo,MC2016_Summer16_WJets_amcatnlo_ext2_v2,MC2016_Summer16_QCD_HT-100-200,MC2016_Summer16_QCD_HT-1000-1500,MC2016_Summer16_QCD_HT-1500-2000,MC2016_Summer16_QCD_HT-200-300,MC2016_Summer16_QCD_HT-2000-Inf,MC2016_Summer16_QCD_HT-300-500,MC2016_Summer16_QCD_HT-500-700,MC2016_Summer16_QCD_HT-700-1000,MC2016_Summer16_DYJetsToLL_10to50_amcatnlo,MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_DYJetsToLL_10to50_amcatnlo_v1_ext1,MC2016_Summer16_DYJetsToLL_50toInf_madgraph_ext2_v1,MC2016_Summer16_DYJetsToLL_10to50_amcatnlo_v2 --chan-groups wjets,wjets_ss,dy_dileptons

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunch1 --chan-groups wjets,wjets_ss,dy_dileptons

# the weights for proc
make sumup_weights

# presel and the new weights procedure
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunch2 --chan-groups tt_presel_cands,tt_presel_lj_mu,tt_presel_lj_el

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunch2 --chan-groups tt_presel_cands,tt_presel_lj_mu,tt_presel_lj_el --dtags MC2016_Summer16_TTJets_powheg

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunch2 --chan-groups tt_presel_cands,tt_presel_lj_mu,tt_presel_lj_el --dtags Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3

python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunch2 --chan-groups wjets,wjets_ss,dy_dileptons,tt_dileptons

# all iso for figure 6 with data-driven qcd estimation
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunch3 --chan-groups tt_alliso_presel

# dy_tautau (dy_mutau dy_eltau) DY tau tau in test5
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunch4 --chan-groups dy_leptau --no-queue --only-nominal
# resubmit (with mT < 40 and dy_mutau_3j with >2 jets requirement)
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunch5 --chan-groups dy_leptau --no-queue --only-nominal
# test the application of event weights
python loop_selections.py --options " --wjets-nup-cut " --nt v37 --proc test5 --distrs bunchT1 --chan-groups dy_leptau --no-queue --job-dir temp/jobs/ --dtags MC2016_Summer16_DYJetsToLL_50toInf_madgraph --chans dy_elel --distributions lep_pt,lep_eta,Mt_lep_met_c --sys NOMINAL,INITIAL
make run_script_jobs job_dir=temp/jobs/ max_procs=10

hadd MC2016_Summer16_DYJetsToLL_50toInf_madgraph.root all/MC2016_Summer16_DYJetsToLL_50toInf_madgraph/dy_leptau/*root


# test run batch
make run_script_jobs job_dir=temp/jobs/
# -- worked
make run_script_jobs job_dir=batch_jobs/ max_procs=10



# v36 test (without presel and alliso)
python genjobs.py v37 test1 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags std_mc,data_mu,data_el
# too few electron data, less than v25 -- checking all stage2 finished
python genjobs.py v37 test1 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags data_el
python genjobs.py v37 test1 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags updowns,updowns_extra
# the wjets shape is wrong again
python genjobs.py v37 test1 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags wjets_amcatnlo
# better in amcatnlo, but still not good at the peak, the recoil corrs were not applied
python genjobs.py v37 test1 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags wjets,wjets_amcatnlo
source queue_dir/v37/test1/jobs_dir/submit

python loop_selections.py --options " --wjets-nup-cut " --distrs bunch5 --dtags MC2016_Summer16_W1Jets_madgraph,MC2016_Summer16_W2Jets_madgraph,MC2016_Summer16_W2Jets_madgraph_ext1,MC2016_Summer16_W3Jets_madgraph,MC2016_Summer16_W3Jets_madgraph_ext1,MC2016_Summer16_W4Jets_madgraph,MC2016_Summer16_W4Jets_madgraph_ext1,MC2016_Summer16_W4Jets_madgraph_ext2,MC2016_Summer16_WJets_amcatnlo,MC2016_Summer16_WJets_amcatnlo_ext2_v2,MC2016_Summer16_WJets_madgraph,MC2016_Summer16_WJets_madgraph_ext2_v1 --chan-groups dy_dileptons,wjets,wjets_ss
# -- no difference
# and comparison of Mt_c to Mt_f in v27p1 is not decisive (damn)
# plot all Mt_f

python loop_selections.py --options " --wjets-nup-cut " --distrs bunch5 --dtags MC2016_Summer16_QCD_HT-100-200,MC2016_Summer16_QCD_HT-1000-1500,MC2016_Summer16_QCD_HT-1500-2000,MC2016_Summer16_QCD_HT-200-300,MC2016_Summer16_QCD_HT-2000-Inf,MC2016_Summer16_QCD_HT-300-500,MC2016_Summer16_QCD_HT-500-700,MC2016_Summer16_QCD_HT-700-1000,Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3 --chan-groups dy_dileptons,wjets,wjets_ss

# lep_pt and mt for the comparison

python loop_selections.py --options " --wjets-nup-cut " --distrs bunch6 --dtags MC2016_Summer16_QCD_HT-100-200,MC2016_Summer16_QCD_HT-1000-1500,MC2016_Summer16_QCD_HT-1500-2000,MC2016_Summer16_QCD_HT-200-300,MC2016_Summer16_QCD_HT-2000-Inf,MC2016_Summer16_QCD_HT-300-500,MC2016_Summer16_QCD_HT-500-700,MC2016_Summer16_QCD_HT-700-1000,Data13TeV_SingleElectron2016B_03Feb2017_ver2,Data13TeV_SingleElectron2016C_03Feb2017_v1,Data13TeV_SingleElectron2016D_03Feb2017_v1,Data13TeV_SingleElectron2016E_03Feb2017_v1,Data13TeV_SingleElectron2016F_03Feb2017_v1,Data13TeV_SingleElectron2016G_03Feb2017_v1,Data13TeV_SingleElectron2016H_03Feb2017_ver2,Data13TeV_SingleElectron2016H_03Feb2017_ver3,Data13TeV_SingleMuon2016B_03Feb2017_ver2,Data13TeV_SingleMuon2016C_03Feb2017_v1,Data13TeV_SingleMuon2016D_03Feb2017_v1,Data13TeV_SingleMuon2016E_03Feb2017_v1,Data13TeV_SingleMuon2016F_03Feb2017_v1,Data13TeV_SingleMuon2016G_03Feb2017_v1,Data13TeV_SingleMuon2016H_03Feb2017_ver2,Data13TeV_SingleMuon2016H_03Feb2017_ver3,MC2016_Summer16_W1Jets_madgraph,MC2016_Summer16_W2Jets_madgraph,MC2016_Summer16_W2Jets_madgraph_ext1,MC2016_Summer16_W3Jets_madgraph,MC2016_Summer16_W3Jets_madgraph_ext1,MC2016_Summer16_W4Jets_madgraph,MC2016_Summer16_W4Jets_madgraph_ext1,MC2016_Summer16_W4Jets_madgraph_ext2,MC2016_Summer16_WJets_amcatnlo,MC2016_Summer16_WJets_amcatnlo_ext2_v2,MC2016_Summer16_WJets_madgraph,MC2016_Summer16_WJets_madgraph_ext2_v1 --chan-groups wjets,wjets_ss

# patch with pat tau sign
python genjobs.py v26 resub4p --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --submit queue 
source queue_dir/v26/resub4p/jobs_dir/submit

# fixed JES JER prop -- [no difference at final selections, although there is difference in all events]
python genjobs.py v25 resub4 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags std_mc --without-dtags MC2016_Summer16_TTJets_powheg
source queue_dir/v25/resub4/jobs_dir/submit

python genjobs.py v26 resub4 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --submit queue 
source queue_dir/v26/resub4/jobs_dir/submit

# resub3 with Tight selection included
python genjobs.py v25 resub3 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags data_mu,data_el 
python genjobs.py v25 resub3 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags Data13TeV_SingleElectron2016H_03Feb2017_ver2
python genjobs.py v25 resub3 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags updowns,updowns_extra
python genjobs.py v25 resub3 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags std_mc --without-dtags MC2016_Summer16_TTJets_powheg
source queue_dir/v25/resub3/jobs_dir/submit

python genjobs.py v26 resub3 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --submit queue 
source queue_dir/v26/resub3/jobs_dir/submit

# v25-v26 with met propagation from lep-matched jet after the el shapes investigation and test1
python genjobs.py v25 resub2 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu,data_el,updowns,updowns_extra --without-dtags MC2016_Summer16_TTJets_powheg --submit queue 
source queue_dir/v25/resub2/jobs_dir/submit

python genjobs.py v25 resub2 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags data_mu,data_el 
python genjobs.py v25 resub2 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags Data13TeV_SingleElectron2016H_03Feb2017_ver2
python genjobs.py v25 resub2 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags updowns,updowns_extra
python genjobs.py v25 resub2 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags std_mc --without-dtags MC2016_Summer16_TTJets_powheg

python genjobs.py v26 resub2 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --submit queue 
source queue_dir/v26/resub2/jobs_dir/submit



# v27 with dileptons, but no extra MC datasets -- no extra DY
python genjobs.py v27 dilep1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu,data_el --submit queue 
python genjobs.py v27 dilep1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --submit queue 
source  queue_dir/v27/dilep1/jobs_dir/submit


# v25-v26 did not have dileptons
# v25-v26 with dilep channels
python genjobs.py v25 dilep1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc --without-dtags MC2016_Summer16_TTJets_powheg --submit queue 
python genjobs.py v25 dilep1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags data_mu,data_el --submit queue 
source queue_dir/v25/dilep1/jobs_dir/submit

python genjobs.py v26 dilep1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --submit queue 
source queue_dir/v26/dilep1/jobs_dir/submit


# v25-v26 rerun while the v40 is being processed
python genjobs.py v25 resub1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu,data_el,updowns,updowns_extra --without-dtags MC2016_Summer16_TTJets_powheg --submit queue 
source queue_dir/v25/resub1/jobs_dir/submit

python genjobs.py v25 resub1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags data_mu,data_el --submit queue 
python genjobs.py v25 resub1 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags Data13TeV_SingleElectron2016H_03Feb2017_ver2
python genjobs.py v25 resub1 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags updowns,updowns_extra
python genjobs.py v25 resub1 --do-W-stitching channels_nom_sys_muon_sel_main --submit queue --dtags std_mc --without-dtags MC2016_Summer16_TTJets_powheg

python genjobs.py v26 resub1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --submit queue 
source queue_dir/v26/resub1/jobs_dir/submit







# v40 p1 run with fixed masses W boson and t quark
#                 added systematic uncertainties in muon ID
#                 and separated trigger uncertainty
python genjobs.py v40 p1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu,data_el --submit queue 
source queue_dir/v40/p1/jobs_dir/submit


# cross check of QCD shape in OS and SS selections
# in presel and wjets control selection
# HT and Enriched QCDs
#  29MB?
# 112M
python genjobs.py v35 pQCDtest channels_nom_sys_muon_sel_main --dtags std_qcd,qcd_ext,qcd_muenriched,qcd_emenriched,qcd_emenriched_ext --scheme 0,0,2,12,12
make sub_proc nt=v35 proc=pQCDtest node=4


# v40 u1
# test run for double ratio with DY
python genjobs.py v40 u1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu,data_el --scheme 0,0,2,12,12
make sub_proc nt=v40 proc=u1 node=1

# redo DY
python genjobs.py v40 u1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_DYJetsToLL_10to50_amcatnlo,MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_DYJetsToLL_50toInf_madgraph_ext2_v1 --scheme 0,0,2,12,12
make sub_proc nt=v40 proc=u1 node=1

# run for DY tautau with nbjets < 2
python genjobs.py v40 u2 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_DYJetsToLL_50toInf_madgraph_ext2_v1 --scheme 0,0,2,12,12
make sub_proc nt=v40 proc=u2 node=1

python genjobs.py v40 u2 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --scheme 0,0,2,12,12

python genjobs.py v40 u2 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc --without-dtags MC2016_Summer16_TTJets_powheg,MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_DYJetsToLL_50toInf_madgraph_ext2_v1 --scheme 0,0,2,12,12

python genjobs.py v40 u3test --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --scheme 0,0,2,12,12
python genjobs.py v40 u3test --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_DYJetsToLL_50toInf_madgraph_ext2_v1 --scheme 0,0,2,12,12
python genjobs.py v40 u3test --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_WJets_madgraph --scheme 0,0,2,12,12

# jet pt cut = 21 = tau pt cut
# plus implemented Mt for object systematics
# -- easy access for the tests and distrs selection
# 13350392	lstore_outdirs/v40/u4test
python genjobs.py v40 u4test --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_WJets_madgraph,MC2016_Summer16_TTJets_powheg,MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_DYJetsToLL_50toInf_madgraph_ext2_v1 --scheme 0,0,2,12,12

2301356	lstore_outdirs/v40/u4test/MC2016_Summer16_DYJetsToLL_50toInf_madgraph
4470408	lstore_outdirs/v40/u4test/MC2016_Summer16_DYJetsToLL_50toInf_madgraph_ext2_v1
6567216	lstore_outdirs/v40/u4test/MC2016_Summer16_TTJets_powheg
11408	lstore_outdirs/v40/u4test/MC2016_Summer16_WJets_madgraph

# trying the batch
python genjobs.py v40 u4test --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_WJets_madgraph,MC2016_Summer16_TTJets_powheg,MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_DYJetsToLL_50toInf_madgraph_ext2_v1 --submit queue 





# run with presel for AN yields table
python genjobs.py v25 pStage2Run5 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu,data_el --without-dtags MC2016_Summer16_TTJets_powheg --scheme 0,0,2,12,12
make sub_proc nt=v25 proc=pStage2Run5 node=1

python genjobs.py v26 pStage2Run5 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --scheme 0,0,2,12,12
make sub_proc nt=v26 proc=pStage2Run5 node=1



# tt with corrected jes-jer and tes
python genjobs.py v25 pStage2Run4 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --scheme 0,0,2,12,12
make sub_proc nt=v25 proc=pStage2Run4 node=1

# it fails in weights of scale systematics
# which are correct in v26:
python genjobs.py v26 pStage2Run4 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --scheme 0,0,2,12,12
make sub_proc nt=v26 proc=pStage2Run4 node=1

# the rest of MC
python genjobs.py v25      pStage2Run4Rest --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc --without-dtags MC2016_Summer16_TTJets_powheg --scheme 0,0,2,12,12
make sub_proc  nt=v25 proc=pStage2Run4Rest node=1





# alliso in mu enriched qcd
python genjobs.py v35 pStage2MuEnriched --do-W-stitching channels_nom_sys_muon_sel_main --dtags qcd_muenriched --scheme 4,4,2,10,10
make sub_proc nt=v35 proc=pStage2MuEnriched node=4

# em enriched for electrons
python genjobs.py v35 pStage2EMEnriched --do-W-stitching channels_nom_sys_muon_sel_main --dtags qcd_emenriched,qcd_emenriched_ext --scheme 0,0,2,10,10
make sub_proc nt=v35 proc=pStage2EMEnriched node=4


# v27 alliso and dileptons
# run with elmu selection to check the b SF factor
python genjobs.py v27 pStage2Run2ElMu --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc --scheme 5,0,0,13,13
make sub_proc nt=v27 proc=pStage2Run2ElMu node=1

# retest with corrections for tau-matching in alliso
python genjobs.py v27 pStage2Run2ElMu2 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_qcd --scheme 0,0,0,10,10
make sub_proc nt=v27 proc=pStage2Run2ElMu2 node=1

# fixed the tau sorting!!! --- no!! all was already ok
python genjobs.py v27 pStage2Run2ElMu3 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_qcd --scheme 0,0,0,10,10
make sub_proc nt=v27 proc=pStage2Run2ElMu3 node=4

# simulating presel better: no b-tau match, only lepton and jets
python genjobs.py v27 pStage2Run2ElMu4 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_qcd --scheme 5,0,0,10,10
make sub_proc nt=v27 proc=pStage2Run2ElMu4 node=4

# simulating presel better: no b-tau match, only lepton and jets
python genjobs.py v27 pStage2Run2ElMu5 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_qcd --scheme 5,0,0,10,0
make sub_proc nt=v27 proc=pStage2Run2ElMu5 node=4

# simulating presel better: no b-tau match, only lepton and jets
python genjobs.py v35 pStage2Run3 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_qcd,qcd_ext --scheme 5,0,0,10,0
make sub_proc nt=v35 proc=pStage2Run3 node=4



# ok for now with bSF fixed
# the events with 0 weight are droped, looking at shape it does not affect things very much
python genjobs.py v25 pStage2Run2 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu,data_el --scheme 4,0,0,12,12
make sub_proc nt=v25 proc=pStage2Run2 node=1

# rerun all MC with fixed bSF Up/Down and TOP PT
python genjobs.py v25 pStage2Run2 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc --scheme 4,0,0,12,12
make sub_proc nt=v25 proc=pStage2Run2 node=1

# rerun with jer propagation to met from all jets including lep-matched 
# no tes propagation
# and vLoose tau CUT -- 1 tau candidate for ID taus (main) and also 1 candidate for alliso selection
python genjobs.py v25 pStage2Run3 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu,data_el --scheme 5,0,0,13,0
make sub_proc nt=v25 proc=pStage2Run3 node=1

# -- have to rerun because the selection was broken with len(leps) == 1

# run for inlcuding updowns and scales in the fit, normalized to the acceptance
# also TES
python genjobs.py v25 r4 channels_nom_sys_both_sel_main --dtags updowns,updowns_extra --scheme 5,0,0,13,13
make sub_proc nt=v25 proc=r4 node=1

# rerun failed dtag
python genjobs.py v25 r4 channels_nom_sys_both_sel_main --dtags MC2016_Summer16_TTJets_powheg_hdampDOWN_ext1 --scheme 5,0,0,13,13
make sub_proc nt=v25 proc=r4 node=1


# run for refact-renorm (correct in v26) and pdf weights
python genjobs.py v26 r4 channels_nom_sys_both_sel_main --dtags MC2016_Summer16_TTJets_powheg --scheme 5,0,1,13,13
make sub_proc nt=v26 proc=r4 node=1






# final test, comparison to old framework results with old b WP
python genjobs.py v25 pStage2Test5 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu,data_el --scheme 5,0,0,12,12
make sub_proc nt=v25 proc=pStage2Test5 node=1

# run on DY with taul-tauh selection
# MC2016_Summer16_DYJetsToLL_50toInf_madgraph
python genjobs.py v25 pStage2DYtest1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_DYJetsToLL_50toInf_madgraph --scheme 5,0,0,12,12
make sub_proc nt=v25 proc=pStage2DYtest1 node=1



# run with all systematics, lj variable, met propagation and new b WP
python genjobs.py v25 pStage2Run1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu,data_el --scheme 5,5,2,12,12
make sub_proc nt=v25 proc=pStage2Run1 node=1

python genjobs.py v25 pStage2Run1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags data_mu,data_el --scheme 5,0,0,12,12
make sub_proc nt=v25 proc=pStage2Run1 node=1


# test run with all systematics
python genjobs.py v25 pStage2Test4 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --scheme 5,5,2,12,12
make sub_proc nt=v25 proc=pStage2Test4 node=1


# first acceptance run

python genjobs.py v34 t1 --acceptance-study channels_nom_sys_both_sel_main --dtags MC2016_Summer16_TTJets_powheg,updowns,updowns_extra --scheme 5,5,2,12,12
make sub_proc nt=v34 proc=t1 node=1


# rerun the old full nominal final selection in mu and el

python genjobs.py v25 pOld1 --old-loop --do-W-stitching channels_nom_sys_both_sel_main --dtags std_mc,data_mu,data_el --scheme 5,5,2,12,12
make sub_proc nt=v25 proc=pOld1 node=1





# stage2_test3
# main info on objects and main weights
python genjobs.py v25 pStage2Test3 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu --scheme 6,6,2,14,14
make sub_proc nt=v25 proc=pStage2Test3 node=1

# stag2_test2
# medium taus
python genjobs.py v25 pStage2Test2 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu --scheme 6,6,2,14,14
make sub_proc nt=v25 proc=pStage2Test2 node=1

# stag2_test1
python genjobs.py v25 pStage2Test1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu --without-dtags MC2016_Summer16_TTJets_powheg --scheme 6,6,2,14,14
make sub_proc nt=v25 proc=pStage2Test1 node=1
python genjobs.py v25 pStage2Test1 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --scheme 6,6,2,14,14
make sub_proc nt=v25 proc=pStage2Test1 node=1




# sublep with only removing the jet
python genjobs.py v25 pCheckTight4SubLep --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --scheme 6,6,2,14,14
python genjobs.py v25 pCheckTight4SubLep --do-W-stitching channels_nom_sys_muon_sel_main --dtags data_mu --scheme 6,6,2,14,14
make sub_proc nt=v25 proc=pCheckTight4SubLep node=1

# checking the effect of Tight tau ID on regMT params
python genjobs.py v25 pCheckTight --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --scheme 7,0,2,15,15
make sub_proc nt=v25 proc=pCheckTight node=1

# more info in regMt
python genjobs.py v25 pCheckTight2 --do-W-stitching channels_nom_sys_muon_sel_main --dtags MC2016_Summer16_TTJets_powheg --scheme 7,0,2,15,15
make sub_proc nt=v25 proc=pCheckTight2 node=1

python genjobs.py v25 pCheckTight2 --do-W-stitching channels_nom_sys_muon_sel_main --dtags data_mu --scheme 5,5,2,12,12
make sub_proc nt=v25 proc=pCheckTight2 node=1

# with tau-jet substitution
python genjobs.py v25 pCheckTight3 --do-W-stitching channels_nom_sys_muon_sel_main --dtags std_mc,data_mu --scheme 5,5,2,12,12
make sub_proc nt=v25 proc=pCheckTight3 node=1

# with tau-jet substitution
python genjobs.py v25 pCheckTight3 --do-W-stitching channels_nom_sys_muon_sel_main --dtags data_mu --scheme 5,5,2,12,12
make sub_proc nt=v25 proc=pCheckTight3 node=1


# checking the effect from nominal TES on met and Mt
python genjobs.py v25 pCheckNomTES --do-W-stitching channels_nom_sys_muon_sel --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,15
make sub_proc nt=v25 proc=pCheckNomTES node=1

# checking the shape difference in mutau selection between niminal and FSR TT
python genjobs.py v25 pCheckNomFSR --do-W-stitching channels_nom_sys_muon_sel --dtags MC2016_Summer16_TTJets_powheg,updowns_allfsr --scheme 5,5,1,12,12
make sub_proc nt=v25 proc=pCheckNomFSR node=1


# pFullElMu
# let's try to get good yields with correct PU and TOPPT norm weights
python genjobs.py v31v27 pFullElMu --without-bSF --do-W-stitching channels_control_regions_elmu --scheme 6,6,2,12,12
make sub_proc nt=v31v27 proc=pFullElMu node=1

# and now really with all systematics
python genjobs.py v31v27 pAllElMu --without-bSF --do-W-stitching channels_control_regions_elmu_allsys --scheme 6,6,2,12,12
make sub_proc nt=v31v27 proc=pAllElMu node=1


# nominal mu with aug rereco
python genjobs.py v32 p2_mu --do-W-stitching channels_nominal_full_mu_selections --dtags data_mu_aug --scheme 6,6,1,12,12
make sub_proc nt=v32 proc=p2_mu node=1


# v32 data -- run on Aug rereco
python genjobs.py v32 p1 --do-W-stitching channels_control_regions_elmu --dtags data_mu_aug --scheme 7,7,2,12,12
make sub_proc  nt=v32 proc=p1 node=1
# -- same bMjet_pt in elmu close


# fixed mu HLT obj matching and met filters, also new separate lep module
python genjobs.py v31v27 pMETfilt --do-W-stitching channels_control_regions_elmu --scheme 7,7,2,12,12
make sub_proc nt=v31v27 proc=pMETfilt node=1

# with HLT mu and el and matching, no b
python genjobs.py v31v27 pBothHLT --without-bSF --do-W-stitching channels_control_regions_elmu --scheme 7,7,2,12,12
make sub_proc nt=v31v27 proc=pBothHLT node=1





# yep.. from pR4 it seems the per-vtx mu iso SF does reduce the difference well
# and the fixed point of PU variation is good now, PU Down corrects only about 2%, when the mismatch in those bins is about 5%
# hopefully top pt will also add to that
# full systematics selection
python genjobs.py v26 pR5 --do-W-stitching channels_full_sys_muon_sel --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,0
make sub_proc nt=v26 proc=pR5 node=1

python genjobs.py v25 pR5 --do-W-stitching channels_full_sys_muon_sel --dtags std_mc,data_mu --without-dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,0
make sub_proc nt=v25 proc=pR5 node=1


# testing the elmu issue with mumu dy
# in principle, the only recent change is the vtx in muon id and iso
# and it can reduce muon mc by about 5%
# which is exactly the excess i used to have in dy
# so it should match now
# if it does then the error is only in elmu
# otherwise -- debug dy (less mc and data)
python genjobs.py v27 pR5_dy --do-W-stitching channels_control_regions_dy --scheme 7,7,2,15,0
make sub_proc nt=v27 proc=pR5_dy node=1

# test without lepton SFs
python genjobs.py v27     pR6_dy --do-W-stitching channels_control_regions_dy --scheme 7,7,2,15,0
make sub_proc nt=v27 proc=pR6_dy node=1

# without impacts (correctly done in ntupler)
python genjobs.py v27     pR7_dy --do-W-stitching channels_control_regions_dy --dtags std_data,MC2016_Summer16_DYJetsToLL_50toInf_madgraph,MC2016_Summer16_DYJetsToLL_10to50_amcatnlo --scheme 7,7,2,15,0
make sub_proc nt=v27 proc=pR7_dy node=1
# rest of MC
python genjobs.py v27     pR7_dy --do-W-stitching channels_control_regions_dy --dtags std_mc --scheme 7,7,2,15,0
make sub_proc nt=v27 proc=pR7_dy node=1




# pR3 fixed the shift in pu_ratio array
#  -- no difference in shape
python genjobs.py v26 pR3 --do-W-stitching channels_nominal_full_mu_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,0
make sub_proc nt=v26 proc=pR3 node=1

# let's get 1 more distr
# regMt lep pt VS Mt and eta
# -- are the Mt bins and low lep pt the same issue? (my bet is yes)
#    is the small skew in eta at 0 connected with low pt?
python genjobs.py v26 pR4 --do-W-stitching channels_nominal_full_mu_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,0
make sub_proc nt=v26 proc=pR4 node=1
python genjobs.py v25 pR4 --do-W-stitching channels_nominal_full_mu_selections --without-dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,0
make sub_proc nt=v25 proc=pR4 node=1



# trying to run roccor test
# pR1
# --dtags std_data,MC2016_Summer16_TTJets_powheg --scheme 5,0,1,10,10
python genjobs.py v27 pR1 --do-W-stitching channels_control_regions_elmu --dtags data_mu,MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,0
make sub_proc nt=v27 proc=pR1 node=1

# trying without lep SFs
# also there was a silly mistake in elmu lep sfs, but it cannot have that large effect
# now the only difference are correct impacts and relIso and no SFs
# also there is control distr for lep SF weight_init
python genjobs.py v27 pR7_em --do-W-stitching channels_control_regions_elmu --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,0
python genjobs.py v27 pR7_em --do-W-stitching channels_control_regions_elmu --dtags data_mu --scheme 7,7,1,15,0
python genjobs.py v27 pR7_em --do-W-stitching channels_control_regions_elmu --without-dtags data_mu,MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,0
make sub_proc nt=v27 proc=pR7_em node=1

# only mu elmu with only mu elmu lep SF
python genjobs.py v27 pR8_em --do-W-stitching channels_control_regions_elmu --scheme 7,7,2,15,0
make sub_proc nt=v27 proc=pR8_em node=1
# looks nice, it seems there is a problem with b SF

# run without bSF
python genjobs.py v27 pR9_em --without-bSF --do-W-stitching channels_control_regions_elmu --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,0
python genjobs.py v27 pR9_em --without-bSF --do-W-stitching channels_control_regions_elmu --dtags singletop,data_mu --scheme 7,7,2,15,0
make sub_proc nt=v27 proc=pR9_em node=1

# check hadron flavours of bMjets
# and also added the check for bMjet pt sorted -- sorting does not help
python genjobs.py v27 pR9_em_hadronFlavours --without-bSF --do-W-stitching channels_control_regions_elmu --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,0
python genjobs.py v27 pR9_em_hadronFlavours --without-bSF --do-W-stitching channels_control_regions_elmu --dtags MC2016_Summer16_TTJets_powheg,singletop --scheme 7,7,2,15,0
# full tt_elmu without bSF
python genjobs.py v27 pR9_em_hadronFlavours --without-bSF --do-W-stitching channels_control_regions_elmu --dtags std_mc,data_mu --without-dtags MC2016_Summer16_TTJets_powheg,singletop --scheme 7,7,2,15,0
make sub_proc nt=v27 proc=pR9_em_hadronFlavours node=1

# pR10 without HLT matching
# -- same yields, matching of muon is practically = 100% in both tt and data
python genjobs.py v27 pR10 --without-bSF --do-W-stitching channels_control_regions_elmu --scheme 7,7,2,12,12
make sub_proc nt=v27 proc=pR10 node=1





# checking the njets in regMt
python genjobs.py v26 pR7_more --do-W-stitching channels_nominal_full_mu_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,0
python genjobs.py v25 pR7_more --do-W-stitching channels_nominal_full_mu_selections --without-dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,0
make sub_proc nt=v25 proc=pR7_more node=1


python genjobs.py v26 pR2 --do-W-stitching channels_nominal_full_mu_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,0
make sub_proc nt=v26 proc=pR2 node=1




# pF3
# only JER prop in MC
# including lep matched and taumatched jets

python genjobs.py v26 pF3 --do-W-stitching --all-jets channels_full_sys_lep_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,15
make sub_proc nt=v26 proc=pF3 node=1

python genjobs.py v25 pF3 --do-W-stitching --all-jets channels_full_sys_lep_selections --without-dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,15
make sub_proc nt=v25 proc=pF3 node=1

# another round with met corrected by all ntuple jets, not only selected ones
python genjobs.py v26 pF4 --do-W-stitching --all-jets channels_full_sys_lep_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,15
make sub_proc nt=v26 proc=pF4 node=1

# still weird distrs
# elmu(mu) had issues with lep pt and met -- let's look into that with correct jet corrs
python genjobs.py v26 pF4_em --do-W-stitching channels_control_regions_elmu --dtags MC2016_Summer16_TTJets_powheg
make sub_proc nt=v26 proc=pF4_em node=1

python genjobs.py v25 pF4_em --do-W-stitching channels_control_regions_elmu --without-dtags MC2016_Summer16_TTJets_powheg
make sub_proc nt=v25 proc=pF4_em node=1

# v25 v26 don't have dileps
python genjobs.py v27 pF4_em --do-W-stitching channels_control_regions_elmu --dtags std_min
make sub_proc nt=v27 proc=pF4_em node=1

# rerun with leptons and met phi distrs
# --dtags std_data,MC2016_Summer16_TTJets_powheg --scheme 5,0,1,10,10
python genjobs.py v27 pF7_em --do-W-stitching channels_control_regions_elmu --dtags std_min  --scheme 5,0,1,10,10
make sub_proc nt=v27 proc=pF7_em node=1

# more distrs in nominal mu
python genjobs.py v26 pF8 --do-W-stitching channels_nominal_full_mu_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,15
python genjobs.py v25 pF8 --do-W-stitching channels_nominal_full_mu_selections --without-dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,15

# tests:
# Mt with shifted met and with lep-sub met
python genjobs.py v26 pF9 --do-W-stitching channels_nominal_full_mu_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,15
# added Mt at 30GeV cut and 120-200 Mt lep-met controls
python genjobs.py v25 pF9 --do-W-stitching channels_nominal_full_mu_selections --without-dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,15

and el
python genjobs.py v26 pF9_el --do-W-stitching channels_nominal_full_el_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,15
python genjobs.py v25 pF9_el --do-W-stitching channels_nominal_full_el_selections --without-dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,15


# ok, elmu is still werid
# in singlemu it seems there is a cluster of mismatch in muon channel
# at muon eta close to 0 (it is also assymetric), tau eta close to 0, high Mt lep-met and tau-met
# and vtx SFs in ID and ISO (ID more pronounced) which, from prev, might correlated with Mt in exactly this manner
# but not sure how it can correlate with tau eta close to 0
# also added presel with 2b requirement to check tt without tau requirement more
python genjobs.py v26 pF5 --do-W-stitching channels_nominal_full_mu_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,15
python genjobs.py v25 pF5 --do-W-stitching channels_nominal_full_mu_selections --without-dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,15

# same in el-tau
python genjobs.py v26 pF6 --do-W-stitching channels_nominal_full_el_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,15
python genjobs.py v25 pF6 --do-W-stitching channels_nominal_full_el_selections --without-dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,15




# pF2 new jets-mets prescription: all miniaod objects (MuClean met in data) and JER factor only
# v26 TT and v25 rest MC + data

python genjobs.py v26 pF2 --do-W-stitching channels_full_sys_lep_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,2,15,15
make sub_proc nt=v26 proc=pF2 node=1

python genjobs.py v25 pF2 --do-W-stitching channels_full_sys_lep_selections --without-dtags MC2016_Summer16_TTJets_powheg --dtags std --scheme 7,7,2,15,15
make sub_proc nt=v25 proc=pF2 node=1


# check data jes recor in v27

python genjobs.py v27 p3 --do-W-stitching channels_nominal_full_mu_selections --dtags data_mu --scheme 7,7,2,15,15
make sub_proc nt=v27 proc=p3 node=1



# running on nominal ntuple jets
# idea is that there are residual differences from discarded jets which propagate to met and that's why met has a bit larger slope in mu channel
# will see if the effect is indeed large enough
# v28 p1_tt only refact renorm systematic
python genjobs.py v28 pF --do-W-stitching channels_full_sys_lep_selections --dtags std_data --scheme 4,4,1,0,8
make sub_proc nt=v28 proc=pF node=2

python genjobs.py v26 pF --do-W-stitching channels_full_sys_lep_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 0,7,2,15,15
make sub_proc nt=v26 proc=pF node=2

python genjobs.py v25 pF --do-W-stitching channels_full_sys_lep_selections --without-dtags MC2016_Summer16_TTJets_powheg --dtags std_mc --scheme 7,7,2,15,15
make sub_proc nt=v25 proc=pF node=1




# v27 p1_tt only refact renorm systematic
python genjobs.py v27 p1 --do-W-stitching channels_control_regions --dtags std_min
make sub_proc nt=v27 proc=p1 node=2

python genjobs.py v27 p1_wz --do-W-stitching channels_control_regions --dtags MC2016_Summer16_WZTo1L1Nu2Q_amcatnlo_madspin
make sub_proc nt=v27 proc=p1_wz node=2

# without el trigger in elmu -- test1
# and with correct other lep SFs -- test2
python genjobs.py v27 p2 --do-W-stitching channels_control_regions_elmu --dtags std_min
make sub_proc nt=v27 proc=p2 node=2

# amcatnlo in control regions
python genjobs.py v27 p1 --do-W-stitching channels_control_regions --dtags wjets_amcatnlo
make sub_proc nt=v27 proc=p1 node=1





# v26 p1_tt only refact renorm systematic
python genjobs.py v26 p1_tt channels_refact_sys_lep_selections --dtags MC2016_Summer16_TTJets_powheg
make sub_proc nt=v26 proc=p1_tt node=2

python genjobs.py v26 p2_tt channels_refact_sys_lep_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,15
make sub_proc nt=v26 proc=p2_tt node=1





# v25 p1 both el mu with new weights
# no change in proc! -- will have to add something in mc_norm
python genjobs.py v25 p1 channels_full_sys_lep_selections
make sub_proc nt=v25 proc=p1 node=1

# p2 includes Vloose for lj bins !
python genjobs.py v25 p2_w0jets channels_full_sys_lep_selections --do-W-stitching --dtags MC2016_Summer16_WJets_madgraph

# p3 just nominal full selection for correct yields
python genjobs.py v25 p3 channels_nominal_full_lep_selections
make sub_proc nt=v25 proc=p3 node=1




# try new distrs in muon data
python genjobs.py v25 p2_check_mudata --do-W-stitching channels_full_sys_lep_selections --dtags data_mu,MC2016_Summer16_TTJets_powheg
make sub_proc nt=v25 proc=p2_check_mudata node=1


# and add presel selection for yields table
python genjobs.py v25 p2_presels channels_presels --do-W-stitching
make sub_proc nt=v25 proc=p2_presels node=1

python genjobs.py v25 p2_updowns channels_full_sys_lep_selections --dtags updowns
make sub_proc nt=v25 proc=p2_updowns node=1


python genjobs.py v25 p2_controls --do-W-stitching channels_control_regions
make sub_proc nt=v25 proc=p2_controls node=1

# and just in case
python genjobs.py v25 p2_control_amcatnlo --do-W-stitching channels_control_regions --dtags wjets_amcatnlo
make sub_proc nt=v25 proc=p2_control_amcatnlo node=1

# redo wjets control amcatnlo std_amcatnlo
python genjobs.py v25 p2_recontrols --do-W-stitching channels_control_regions_wjets --dtags std_amcatnlo
make sub_proc nt=v25 proc=p2_recontrols node=1


python genjobs.py v25 p2_tt_jtau channels_full_sys_lep_selections --dtags MC2016_Summer16_TTJets_powheg
make sub_proc nt=v25 proc=p2_tt_jtau node=1

python genjobs.py v25 p2_jes_recor channels_full_sys_lep_selections --dtags MC2016_Summer16_TTJets_powheg
make sub_proc nt=v25 proc=p2_jes_recor node=1

python genjobs.py v25 p2_jes_recor_allj channels_full_sys_lep_selections --dtags MC2016_Summer16_TTJets_powheg
make sub_proc nt=v25 proc=p2_jes_recor_allj node=1

python genjobs.py v25 p2_jes_recor_allj_data channels_full_sys_lep_selections --dtags std_data
make sub_proc nt=v25 proc=p2_jes_recor_allj_data node=1
# <-- this were not true allj! the variation was not propagated for taumatched!

python genjobs.py v25 p2_jes_recor_data_trueallj channels_full_sys_lep_selections --dtags std_data --scheme 7,7,1,0,15
make sub_proc nt=v25 proc=p2_jes_recor_data_trueallj node=1

python genjobs.py v25 p2_jes_recor_tt_trueallj channels_full_sys_lep_selections --dtags MC2016_Summer16_TTJets_powheg --scheme 7,7,1,15,15
make sub_proc nt=v25 proc=p2_jes_recor_tt_trueallj node=1

# finally extra
python genjobs.py v25 p2_updowns_extra channels_full_sys_lep_selections --dtags updowns_extra
make sub_proc nt=v25 proc=p2_updowns_extra node=1

# updowns extra
python genjobs.py v25 p2N_updowns_extra channels_full_sys_lep_selections --dtags updowns_extra
make sub_proc nt=v25 proc=p2N_updowns_extra node=1

# add these
MC2016_Summer16_TTJets_powheg_CUETP8M2T4down_ext1
MC2016_Summer16_TTJets_powheg_isrdown_ext2
MC2016_Summer16_TTJets_powheg_CUETP8M2T4up_ext1
MC2016_Summer16_TTJets_powheg_isrup_ext2
MC2016_Summer16_TTJets_powheg_fsrup_ext2



# b90a003e63be8134e03bca526aa864590e0a95c9
# corrected alphaS ubnormal weight in couple tt->taumutauh events, same issue as in PDFs

python genjobs.py v25 p2_rett --do-W-stitching channels_full_sys_lep_selections --dtags MC2016_Summer16_TTJets_powheg
make sub_proc nt=v25 proc=p2_rett node=1



# checked the PDF weights -- seem ok both in mu and el channels -- ??
# resub just tt for mu and v24 el selections

python genjobs.py v23 p5 channels_full_sys_muon_selections --dtags MC2016_Summer16_TTJets_powheg
make sub_proc nt=v23 proc=p5 node=1

python genjobs.py v23 p5_rest channels_full_sys_muon_selections --without-dtags MC2016_Summer16_TTJets_powheg
make sub_proc nt=v23 proc=p5_rest node=1


python genjobs.py v24 p1 channels_full_sys_electron_selections --dtags MC2016_Summer16_TTJets_powheg
make sub_proc nt=v24 proc=p1 node=1

python genjobs.py v24 p1_rest channels_full_sys_electron_selections --without-dtags MC2016_Summer16_TTJets_powheg
make sub_proc nt=v24 proc=p1_rest node=1


# v23 p6
# check PDF fix
# and preparation of lj-binned shapes from Vloose
python genjobs.py v23 p6 channels_full_sys_muon_selections --dtags MC2016_Summer16_TTJets_powheg
make sub_proc nt=v23 proc=p6 node=1

